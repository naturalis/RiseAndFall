<beast>

  <!-- the names of all distinct rows across alignments as a flat list, distinguish between in and outgroup -->

  <taxa id="taxa">
		<taxon id="taxon_55054_1"/>
		<taxon id="taxon_55054_2"/>
		<taxon id="taxon_55054_3"/>
		<taxon id="taxon_59456_1"/>
		<taxon id="taxon_700936_1"/>
		<taxon id="taxon_700936_2"/>
		<taxon id="taxon_700936_3"/>
	  </taxa>  
  <taxa id="ingroup">
		<taxon idref="taxon_55054_1"/>
		<taxon idref="taxon_55054_2"/>
		<taxon idref="taxon_55054_3"/>
		<taxon idref="taxon_59456_1"/>
		<taxon idref="taxon_700936_1"/>
		<taxon idref="taxon_700936_2"/>
		<taxon idref="taxon_700936_3"/>
	  </taxa>
  
    
  <!-- coalescent process with constant population size -->
  <constantSize id="constant" units="substitutions">
    <populationSize>
      <parameter id="constant.popSize" lower="0.0" upper="Infinity" value="0.005"/>
    </populationSize>
  </constantSize> 
  
  <!-- data and model settings for all the alignments -->
                        <alignment dataType="nucleotide" id="clade44/clusters/cluster4.fa">
                                <!-- aligned sequence data for http://ncbi.nlm.nih.gov/nuccore/21263024 -->
          <sequence><taxon idref="taxon_55054_1"/>TTAAACTACTCCTTGAACTGGCTATGTTATTCGTGCATAAATCCCACTACCACATATTAACGAATTACATATATGTATAATAGTACATTATATTATGTACCCCATGAATATTAAGCAAGTAATTTAATTCAATGTATAAATGATATAATATTATATATCAACAGTTAAGATTAATACCAATATGGATAATTCACTAATGATTATATATGATTAATCAGCTGTAGGACATAATATTTATTAATCGTGCATAGACCATTACTACTTCTATTTAATCCTTGTCAATACGCCTATCCCCCACCAAAGGGTG-------</sequence>
                                        <!-- aligned sequence data for http://ncbi.nlm.nih.gov/nuccore/2952038 -->
          <sequence><taxon idref="taxon_55054_2"/>-----------------CTGGCTATGTTATTCGTGCATAAATCCCACTACCACATATTAATGAATTACATATATGTATAATAGTACATTATATTATGTACCCCATGAATATTAAGCAAGTAATTTAATTCAATGTGTAAATGATATAATATTATATATCAACAGTTAAGATTAATATCAATATGGATAATTCATTAATGATTATATATGATTAATCAGCTGTAGGACATAATATTTATTAATCGTGCATAGACCATTACTACTTCTATTTAATCCTTGTCAATACGCCTATCCCCCACCAAAGGGTGTCTCTTA</sequence>
                                        <!-- aligned sequence data for http://ncbi.nlm.nih.gov/nuccore/21263022 -->
          <sequence><taxon idref="taxon_55054_3"/>TTAAACTACTCCTTGAACTGGCTATGTTATTCGTGCATAAATCCCACTACCACATATTAATGAATTACATGTATGTATAATAGTACATTATATTATGTACCTCATGAATATTAAGCAAGTAATTTAATTCAATGTGTAAATGATATAATATTATATATCAACAGTTAAGATTAATATCAATATGGATAATTCATTAATGATTATATATGATTAATCAGCTGTAGGACATAATATTTATTAATCGTGCATAGACCATTACTACTTCTATTTAATCCTTGTCAATACGCCTATCCCCCACCAAAGGGTG-------</sequence>
                                        <!-- aligned sequence data for http://ncbi.nlm.nih.gov/nuccore/2952037 -->
          <sequence><taxon idref="taxon_59456_1"/>-----------------TCGGTGATGCCAGGAGCGCATCACTCTTATTACCCCATATTAATGAATGACATATATGTATAATAGTACATGATATTATGCACCTCATGAATATTAAGCAAGTAATTTAATTCAATGTATGAATGATATATTATTATATATTAACAGTCAAAATT-ATATCAATATGGATAATTCACTAATGATTATATATGATTAATCAGCTGTAGGACATAATATTTATTAATCGTGCATAGACCATG-CTG-TTATATTTAATTCTTATCAATACGACTATCCCCCGACAAAGGGTGTCCCTTG</sequence>
                                        <!-- aligned sequence data for http://ncbi.nlm.nih.gov/nuccore/69208291 -->
          <sequence><taxon idref="taxon_700936_1"/>-----------------CTGGCTATGTTATTCGTGCATAACTCCCATTACCACATATTAATGAATGACATATATGTATAATAGTACATTATATTATGTACCTCATGAATATTAAGCAAGTAATTTAGTTTAATGTATGGATGACATAATATTATATATCAACAGTCAAGATTAATACCAATATGGATAATTCATTAATGATTATATATGATTAATCAGCTGTAGGACATAATATTTATTAATCGTGCATAGACCATT-CCATTTTCATTTAATCCTTGTCAATACGCCTATCCCCTACCAAAGGGTGTCTCT--</sequence>
                                        <!-- aligned sequence data for http://ncbi.nlm.nih.gov/nuccore/69208273 -->
          <sequence><taxon idref="taxon_700936_2"/>-----------------CTGGCTATGTTATTCGTGCATAACTCCCATTACCACATATTAATGAATGACATATATGTATAATAGTACATTATATTATGTACCCCATGAATATTAAGCAAGTAATTTAGTTTAATGTATGAATGACATAATATTATATATCAACAGTCAAGATTAATATCAATATGGATAATTCATTAATGATTATATATGATTAATCAGCTGTAGGACATAATATTTATTAATCGTGCATAGACCATC-CCATTTTCATTTAATCCTTGTCAATACGCCTATCCCCTACCAAAGGGTGTCTCT--</sequence>
                                        <!-- aligned sequence data for http://ncbi.nlm.nih.gov/nuccore/69208287 -->
          <sequence><taxon idref="taxon_700936_3"/>-----------------CTGGCTATGTTATTCGTGCATAACTCCCATTACCACATATTAATGAATGACATATATGTATAATAGTACATTATATTATGTACCCCATGAATATTAAGCAAGTAATTTAGTTTAATGTATGAATGACATAATATTATATATCAACAGTCAAGATTAATACCAATATGGATAATTCATTAATGATTATATATGATTAATCAGCTGTAGGACATAATATTTATTAATCGTGCATAGACCATT-CCATTTTCATTTAATCCTTGTCAATACGCCTATCCCCTACCAAAGGGTGTCCCT--</sequence>
              
    </alignment>
    
    <!-- site patterns -->
    <patterns from="1" id="clade44/clusters/cluster4.fa.patterns">
      <alignment idref="clade44/clusters/cluster4.fa"/>
    </patterns>
    
    <!-- coalescent starting tree -->
    <coalescentTree id="clade44/clusters/cluster4.fa.startingTree" rootHeight="0.02">
      <constrainedTaxa>
		<taxa idref="taxa"/>
 		<tmrca monophyletic="true"> 
		  <taxa idref="ingroup"/> 
		</tmrca>
	  </constrainedTaxa>
      <constantSize idref="constant"/>
    </coalescentTree> 
    
    <!-- tree model -->
    <treeModel id="clade44/clusters/cluster4.fa.treeModel">
      <coalescentTree idref="clade44/clusters/cluster4.fa.startingTree"/>
      <rootHeight>
        <parameter id="clade44/clusters/cluster4.fa.treeModel.rootHeight"/>
      </rootHeight>
      <nodeHeights internalNodes="true">
        <parameter id="clade44/clusters/cluster4.fa.treeModel.internalNodeHeights"/>
      </nodeHeights>
      <nodeHeights internalNodes="true" rootNode="true">
        <parameter id="clade44/clusters/cluster4.fa.treeModel.allInternalNodeHeights"/>
      </nodeHeights>
    </treeModel>

	<!-- constrain ingroup to be monophyletic -->   
	<tmrcaStatistic id="tmrca.ingroup.clade44/clusters/cluster4.fa" includeStem="false"> 
      <mrca>
		<taxa idref="ingroup"/>   
      </mrca>                                                   
      <treeModel idref="clade44/clusters/cluster4.fa.treeModel"/>
	</tmrcaStatistic>
	<monophylyStatistic id="monophyly.ingroup.clade44/clusters/cluster4.fa">
      <mrca>
		<taxa idref="ingroup"/>
      </mrca>
      <treeModel idref="clade44/clusters/cluster4.fa.treeModel"/>
	</monophylyStatistic>
	
    <!-- coalescent likelihood -->
    <coalescentLikelihood id="clade44/clusters/cluster4.fa.coalescent">
      <model><constantSize idref="constant"/></model>
      <populationTree><treeModel idref="clade44/clusters/cluster4.fa.treeModel"/></populationTree>
    </coalescentLikelihood>

    <!-- strict clock parameters -->
    <strictClockBranchRates id="clade44/clusters/cluster4.fa.branchRates">
      <rate>
        
          <parameter id="clade44/clusters/cluster4.fa.clock.rate" value="1.0"/>
        
      </rate>
    </strictClockBranchRates>
    
    <!-- HKY85 substitution model parameters -->
    <HKYModel id="clade44/clusters/cluster4.fa.hky">
      <frequencies>
        <frequencyModel dataType="nucleotide">
          <alignment idref="clade44/clusters/cluster4.fa"/>
          <frequencies>
            <parameter dimension="4" id="clade44/clusters/cluster4.fa.frequencies"/>
          </frequencies>
        </frequencyModel>
      </frequencies>
      <kappa>
        <parameter id="clade44/clusters/cluster4.fa.kappa" lower="0.0" value="2.0"/>
      </kappa>
    </HKYModel>

    <!-- site model: HKY85+G -->
    <siteModel id="clade44/clusters/cluster4.fa.siteModel">
      <gammaShape gammaCategories="4">
        <parameter id="clade44/clusters/cluster4.fa.alpha" lower="0.0" value="0.5"/>
      </gammaShape>
      <substitutionModel>
        <HKYModel idref="clade44/clusters/cluster4.fa.hky"/>
      </substitutionModel>
    </siteModel>

    <!-- tree likelihood model -->  
    <treeLikelihood id="clade44/clusters/cluster4.fa.treeLikelihood" useAmbiguities="false">
      <patterns idref="clade44/clusters/cluster4.fa.patterns"/>
      <treeModel idref="clade44/clusters/cluster4.fa.treeModel"/>
      <siteModel idref="clade44/clusters/cluster4.fa.siteModel"/>
      <strictClockBranchRates idref="clade44/clusters/cluster4.fa.branchRates"/>
    </treeLikelihood>
     
  
  <!-- species normalization -->
  <species id="species">
                    
                                                                              
                            <!-- reference to the species http://ncbi.nlm.nih.gov/taxonomy/55054 -->
          <sp id="55054">
                      <!-- reference to a distinct row name across all alignments -->
            <taxon idref="taxon_55054_2"/>
                      <!-- reference to a distinct row name across all alignments -->
            <taxon idref="taxon_55054_1"/>
                      <!-- reference to a distinct row name across all alignments -->
            <taxon idref="taxon_55054_3"/>
                    </sp>
                    
                                          
                            <!-- reference to the species http://ncbi.nlm.nih.gov/taxonomy/59456 -->
          <sp id="59456">
                      <!-- reference to a distinct row name across all alignments -->
            <taxon idref="taxon_59456_1"/>
                    </sp>
                    
                                                                              
                            <!-- reference to the species http://ncbi.nlm.nih.gov/taxonomy/700936 -->
          <sp id="700936">
                      <!-- reference to a distinct row name across all alignments -->
            <taxon idref="taxon_700936_1"/>
                      <!-- reference to a distinct row name across all alignments -->
            <taxon idref="taxon_700936_3"/>
                      <!-- reference to a distinct row name across all alignments -->
            <taxon idref="taxon_700936_2"/>
                    </sp>
                      <geneTrees id="geneTrees">
      
        
        <!-- reference to the tree model for clade44/clusters/cluster4.fa -->
        <treeModel idref="clade44/clusters/cluster4.fa.treeModel"/>
      
    </geneTrees>
  </species>

  <!-- species tree: provides per branch demographic function -->  
  <speciesTree constantRoot="true" id="sptree">
    <species idref="species"/>
    <sppSplitPopulations value="0.02">
      <parameter id="speciesTree.splitPopSize"/>
    </sppSplitPopulations>
  </speciesTree>

  <!-- species tree: birth/death model -->
  <birthDeathModel id="birthDeath" units="substitutions">
    <birthMinusDeathRate>
      <parameter id="species.birthDeath.meanGrowthRate" lower="0.0" upper="Infinity" value="1.0"/>
    </birthMinusDeathRate>
    <relativeDeathRate>
      <parameter id="species.birthDeath.relativeDeathRate" lower="0.0" upper="1.0" value="0.5"/>
    </relativeDeathRate>
  </birthDeathModel>

  <!-- species tree: likelihood -->
  <speciationLikelihood id="speciation.likelihood">
    <model>
      <birthDeathModel idref="birthDeath"/>
    </model>
    <speciesTree>
      <speciesTree idref="sptree"/>
    </speciesTree>
  </speciationLikelihood>
  <tmrcaStatistic id="speciesTree.rootHeight" name="speciesTree.rootHeight">
    <speciesTree idref="sptree"/>
    <mrca>
      <taxa>
        
          
            
              <!-- reference to species 55054 -->
              <sp idref="55054"/>
            
          
            
              <!-- reference to species 59456 -->
              <sp idref="59456"/>
            
          
            
              <!-- reference to species 700936 -->
              <sp idref="700936"/>
            
          
        
      </taxa>
    </mrca>
  </tmrcaStatistic>
  <speciesCoalescent id="species.coalescent">
    <species idref="species"/>
    <speciesTree idref="sptree"/>
  </speciesCoalescent>

  <!-- species tree: gamma2 + gamma4 -->  
  <mixedDistributionLikelihood id="species.popSize">
    <distribution0>
      <gammaDistributionModel>
        <scale><parameter id="species.popMean" lower="0.0" value="0.01"/></scale>
        <shape>2</shape>
      </gammaDistributionModel>
    </distribution0>
    <distribution1>
      <gammaDistributionModel>
        <shape>4</shape>
        <scale><parameter idref="species.popMean"/></scale>
      </gammaDistributionModel>
    </distribution1>
    <data>
      <parameter idref="speciesTree.splitPopSize"/>
    </data>
    <indicators>
                                                                                                                          <parameter value="1 1 1 0 0 0 0"/>
    </indicators>
  </mixedDistributionLikelihood>
  
  <!-- proposal mechanisms -->
  <operators id="operators">
                
      <!-- proposal mechanisms for clade44/clusters/cluster4.fa -->
      <!-- operators for the substitution process -->
      <scaleOperator scaleFactor="0.75" weight="0.1">
        <parameter idref="clade44/clusters/cluster4.fa.alpha"/>
      </scaleOperator>
      <scaleOperator scaleFactor="0.75" weight="0.1">
        <parameter idref="clade44/clusters/cluster4.fa.kappa"/>
      </scaleOperator>
      <deltaExchange delta="0.01" weight="1">
        <parameter idref="clade44/clusters/cluster4.fa.frequencies"/>
      </deltaExchange>
      <!-- operators for the tree topology -->
      <subtreeSlide gaussian="true" size="0.001" weight="15">
        <treeModel idref="clade44/clusters/cluster4.fa.treeModel"/>
      </subtreeSlide>
      <narrowExchange weight="15">
        <treeModel idref="clade44/clusters/cluster4.fa.treeModel"/>
      </narrowExchange>
      <wideExchange weight="3">
        <treeModel idref="clade44/clusters/cluster4.fa.treeModel"/>
      </wideExchange>
      <wilsonBalding weight="3">
        <treeModel idref="clade44/clusters/cluster4.fa.treeModel"/>
      </wilsonBalding>
      <scaleOperator scaleFactor="0.75" weight="3">
        <parameter idref="clade44/clusters/cluster4.fa.treeModel.rootHeight"/>
      </scaleOperator>
      <uniformOperator weight="30">
        <parameter idref="clade44/clusters/cluster4.fa.treeModel.internalNodeHeights"/>
      </uniformOperator>
      
        <upDownOperator scaleFactor="0.75" weight="3">
          <up></up>
         <down><parameter idref="clade44/clusters/cluster4.fa.treeModel.allInternalNodeHeights"/></down>
        </upDownOperator>
      
    
    <!-- combined up/down operator -->
    <upDownOperator scaleFactor="0.75" weight="30">
      <up>
                                                              <parameter idref="species.birthDeath.meanGrowthRate"/>
      </up>
      <down>
        <speciesTree idref="sptree"/>
        <parameter idref="species.popMean"/>
        <parameter idref="speciesTree.splitPopSize"/>
                  
            <parameter idref="clade44/clusters/cluster4.fa.treeModel.allInternalNodeHeights"/>
              </down>
    </upDownOperator>
    <!-- operators for the diversification process -->
    <scaleOperator scaleFactor="0.75" weight="3">
      <parameter idref="species.birthDeath.relativeDeathRate"/>
    </scaleOperator>
    <scaleOperator scaleFactor="0.5" weight="94">
      <parameter idref="speciesTree.splitPopSize"/>
    </scaleOperator>
    <scaleOperator scaleFactor="0.9" weight="5">
      <parameter idref="species.popMean"/>
    </scaleOperator>
    <scaleOperator scaleFactor="0.75" weight="3">
      <parameter idref="species.birthDeath.meanGrowthRate"/>
    </scaleOperator>
    <nodeReHeight weight="94">
      <species idref="species"/>
      <speciesTree idref="sptree"/>
    </nodeReHeight>
  </operators>
  
  <!-- mcmc settings -->
  <mcmc autoOptimize="true" chainLength="30000000" id="mcmc">
  
    <!-- posterior -->
    <posterior id="posterior">
    
      <!-- priors -->
      <prior id="prior">
        <speciesCoalescent idref="species.coalescent"/>
        <mixedDistributionLikelihood idref="species.popSize"/>
        <speciationLikelihood idref="speciation.likelihood"/>
        
          
          <!-- priors for clade44/clusters/cluster4.fa -->
          <logNormalPrior mean="1.0" meanInRealSpace="false" offset="0.0" stdev="1.25">
            <parameter idref="clade44/clusters/cluster4.fa.kappa"/>
          </logNormalPrior>
          <exponentialPrior mean="0.5" offset="0.0">
            <parameter idref="clade44/clusters/cluster4.fa.alpha"/>
          </exponentialPrior>
          <coalescentLikelihood idref="clade44/clusters/cluster4.fa.coalescent"/>
		  <booleanLikelihood>
			<monophylyStatistic idref="monophyly.ingroup.clade44/clusters/cluster4.fa"/>
		  </booleanLikelihood>
        

        <!-- diversification priors -->
        <logNormalPrior mean="-7.0" stdev="2.0">
          <parameter idref="species.popMean"/>
        </logNormalPrior> 
        <logNormalPrior mean="4.6" stdev="2.0">
          <parameter idref="species.birthDeath.meanGrowthRate"/>
        </logNormalPrior>
        <betaPrior shape="1.0" shapeB="1.0">
          <parameter idref="species.birthDeath.relativeDeathRate"/>
        </betaPrior>

      </prior>
      
      <!-- likelihood -->
      <likelihood id="likelihood">
        
                
          <treeLikelihood idref="clade44/clusters/cluster4.fa.treeLikelihood"/>
        
      </likelihood>
    </posterior>
    
    <!-- operators -->
    <operators idref="operators"/>
    
    <!-- where to log parameters -->
    <log fileName="./clade44/clade44.log" logEvery="1000">
      <posterior idref="posterior"/>
      <prior idref="prior"/>
      <likelihood idref="likelihood"/>
      <parameter idref="species.popMean"/>
      <parameter idref="speciesTree.splitPopSize"/>
      <parameter idref="species.birthDeath.meanGrowthRate"/>
      <parameter idref="species.birthDeath.relativeDeathRate"/>
      
        
        <parameter idref="clade44/clusters/cluster4.fa.treeModel.rootHeight"/>
        <parameter idref="clade44/clusters/cluster4.fa.kappa"/>
        <parameter idref="clade44/clusters/cluster4.fa.frequencies"/>
        <parameter idref="clade44/clusters/cluster4.fa.clock.rate"/>
        <treeLikelihood idref="clade44/clusters/cluster4.fa.treeLikelihood"/>
        <coalescentLikelihood idref="clade44/clusters/cluster4.fa.coalescent"/>
      
    </log>
    
    <!-- where to log output species trees -->
    <logTree 
      fileName="./clade44/clade44.nex" 
      id="species.treeFileLog" 
      logEvery="1000" 
      nexusFormat="true" 
      sortTranslationTable="true">
      <speciesTree idref="sptree"/>
      <posterior idref="posterior"/>
    </logTree>
    
  </mcmc>
</beast>
